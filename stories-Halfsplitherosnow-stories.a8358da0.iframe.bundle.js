"use strict";(self.webpackChunkentertainer_redesign=self.webpackChunkentertainer_redesign||[]).push([[665],{"./src/config/firebase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{db:()=>db});var firebase_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/firebase/app/dist/esm/index.esm.js"),firebase_firestore__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js");const app=(0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.Wp)({apiKey:"AIzaSyDLmVO4qOiYb8dTm9tIUSUyZZXliuddo1c",authDomain:"storybook-58efc.firebaseapp.com",projectId:"storybook-58efc",storageBucket:"storybook-58efc.firebasestorage.app",messagingSenderId:"10714570266",appId:"1:10714570266:web:1086b72b26588d72193ba3"}),db=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.aU)(app)},"./src/stories/Halfsplitherosnow.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HalfAndHalfHeroSnow:()=>HalfAndHalfHeroSnow,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Halfsplitherosnow_stories});var objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),firebase=__webpack_require__("./src/config/firebase.js"),index_esm=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const HalfSplitHeroSnow=_ref=>{let{image,imagealt,videosrc,background,textColor,headline,tagline,link,linktext,dataElementType,datapromotionindex,datapromotionname,src,isMuted}=_ref;const refVideo=(0,react.useRef)(null);return(0,react.useEffect)((()=>{var _refVideo$current;videosrc&&" "!==videosrc&&(refVideo.current.defaultMuted=!0,refVideo.current.muted=!0,refVideo.current.srcObject=src,null===(_refVideo$current=refVideo.current)||void 0===_refVideo$current||_refVideo$current.load())}),[isMuted,src,videosrc]),(0,react.useEffect)((()=>{const container=document.querySelector(".media.snow");if(!container)return;const symbols=["❄","❅","❆"],random=(min,max)=>Math.random()*(max-min)+min;function createSnowflake(){if(!container)return;const flake=document.createElement("div");flake.classList.add("snowflake"),flake.innerText=symbols[Math.floor(Math.random()*symbols.length)],flake.style.left="".concat(random(0,100),"%"),flake.style.fontSize="".concat(random(.8,2),"em"),flake.style.opacity=random(.5,1),flake.style.animationDuration="".concat(random(5,10),"s"),flake.style.animationDelay="".concat(random(0,15),"s"),flake.style.setProperty("--horizontal-drift","".concat(random(-15,15),"vw")),flake.style.setProperty("--rotation","".concat(random(-360,360),"deg")),Math.random()>.8&&flake.classList.add("flare"),Math.random()>.5&&flake.classList.add("blurred"),container.appendChild(flake),flake.addEventListener("animationend",(()=>flake.remove()))}for(let i=0;i<100;i++)createSnowflake();const interval=setInterval(createSnowflake,500);return()=>{clearInterval(interval),container.innerHTML=""}}),[]),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("style",{children:"\n      /* Snowflake base style */\n        .snowflake {\n            position: absolute;\n            top: -50px;\n            color: white;\n            font-size: 0.5em;\n            opacity: 0.8;\n            pointer-events: none;\n            user-select: none;\n            animation: fall linear infinite;\n            z-index: 100;\n        }\n\n        /* Falling animation with slight drift */\n        @keyframes fall {\n            to {\n                transform: translateX(var(--horizontal-drift)) translateY(100vh) rotate(var(--rotation));\n            }\n        }\n\n        /* Lens flare effect style */\n        .flare {\n            filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.7)) drop-shadow(0 0 12px rgba(255, 255, 255, 0.5));\n        }\n\n        /* Blurred snowflake for depth */\n        .blurred {\n            filter: blur(2px);\n            opacity: 0.5;\n        }\n    .hero-card-container {\n        padding: 0 20px 30px 20px;\n        background-color: #dbe3ff;\n        height: 100%;\n    }\n\n    .hero-card {\n        max-width: 1400px;\n        margin: 0 auto;\n        display: flex;\n        flex-flow: column;\n        flex-direction: column;\n        height: 100%;\n    }\n\n    .hero-card .media {\n        aspect-ratio: 335/188;\n        border-radius: 8px;\n        overflow: hidden;\n        position: relative;\n    }\n\n    .hero-card .media img,\n    .hero-card .media iframe,\n    .hero-card .media video {\n        object-fit: cover;\n        width: 100%;\n        height: 100%;\n        position: relative;\n        z-index: 2;\n    }\n\n    .hero-card .hero-tile-info {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        text-align: center;\n        background: ".concat(background,';\n        border-radius: 8px;\n        position: relative;\n        margin-top: -20px;\n        padding: 40px 25px 20px 25px;\n        flex-grow: 1;\n    }\n\n    .hero-card .hero-tile-info .brand-logo {\n        position: absolute;\n        top: -32px;\n        height: 40px;\n        z-index: 2;\n    }\n\n    .hero-card .hero-tile-info .brand-logo img,\n    .hero-card .hero-tile-info .brand-logo svg {\n        height: 100%;\n        width: auto;\n    }\n\n    .hero-card .hero-tile-info h2 {\n        font-size: 20px;\n        font-family: "Nunito Bold","Tahoma Bold",sans-serif;\n        font-weight: bold;\n        color: ').concat(textColor||"#fff",";\n        margin: 0 0 20px;\n        line-height: 24px;\n    }\n\n    .hero-card .hero-tile-info .hero-blurb {\n        color: ").concat(textColor||"#fff",";\n        font-size: 14px;\n        font-weight: 200;\n        margin-bottom: 20px;\n    }\n\n    .hero-card .flickity-viewport {\n        aspect-ratio: 335/307;\n    }\n\n    .hero-card .hero-button {\n        display: inline-flex;\n        align-items: center;\n        justify-content: center;\n        border-radius: 50px;\n        background-color: #009E44;\n        color: #fff;\n        font-size: 16px;\n        font-weight: bold;\n        text-decoration: none;\n        padding: 10px 30px 10px 10px;\n        height: 40px;\n        box-shadow: 0 0 5px rgba(3,33,33,.3);\n        border: 3px solid #DBE3FF;\n        transition: all 0.3s;\n    }\n\n    .hero-card .hero-button:hover {\n        background-color: #AFCB17;\n        scale: 1.05;\n        box-shadow: 0 0 18px rgba(3,33,33,.3);\n        color: #fff;\n    }\n\n    .hero-card .hero-button .basket-icon {\n        transition: all 0.3s;\n        transform: rotate(15deg);\n        margin-left: 5px;\n    }\n\n    .hero-card .hero-button:hover .basket-icon {\n        transform: rotate(-10deg)\n    }\n\n    .hero-card .hero-button .star-start {\n        position: relative;\n        top: -3px;\n    }\n\n    .hero-card .hero-button .swoosh-container {\n        display: flex;\n        align-items: center;\n        justify-content: end;\n        margin-right: 5px;\n        width: 25px;\n    }\n\n    .hero-card .hero-button .swoosh {\n        display: block;\n        width: 0;\n        height: 3px;\n        margin-top: -3px;\n        margin-left: -2px;\n        transform: rotate(15deg);\n        background-color: rgba(255, 255, 255, 0.7);\n        transition: all 0.3s;\n    }\n\n    .hero-card .hero-button:hover .swoosh {\n        width: 7px;\n    }\n\n    .hero-card .hero-button .star-end {\n        position: relative;\n        bottom: -5px;\n        transition: all 0.3s;\n    }\n\n    .hero-card .hero-button:hover .star-end {\n        scale: 1.1;\n        transform: rotate(30deg);\n    }\n\n    @media (min-width: 768px) {\n        .hero-card {\n            flex-flow: row-reverse;\n            align-items: stretch;\n        }\n\n        .hero-card .media {\n            width: 50%;\n            aspect-ratio: 16/9;\n        }\n\n        .hero-card .hero-tile-info {\n            padding: 20px 30px 20px 20px;\n            margin-top: 0;\n            margin-right: -20px;\n            width: calc(50% + 20px);\n        }\n\n        .hero-card .hero-tile-info .brand-logo {\n            position: relative;\n            top: 0;\n            margin-bottom: 20px;\n            height: 90px;\n        }\n\n        .hero-card .hero-tile-info h2 {\n            font-size: 24px;\n            margin: 0;\n        }\n\n        .hero-card .hero-tile-info .hero-blurb {\n            display: block;\n            margin: 12px 0;\n        }\n    }\n ")}),(0,jsx_runtime.jsx)("div",{class:"hero-card-container",children:(0,jsx_runtime.jsxs)("a",{href:link,"data-element-type":dataElementType,"data-promotion-index":datapromotionindex,"data-promotion-name":datapromotionname,class:"hero-card",children:[(0,jsx_runtime.jsxs)("div",{class:"media snow",children:[image&&" "!==image&&(0,jsx_runtime.jsx)("img",{src:image,alt:imagealt||"Hero image"}),videosrc&&" "!==videosrc&&(0,jsx_runtime.jsx)("video",{ref:refVideo,autoPlay:!0,loop:!0,playsInline:!0,children:(0,jsx_runtime.jsx)("source",{src:videosrc,type:"video/mp4"})})]}),(0,jsx_runtime.jsxs)("div",{class:"hero-tile-info",style:{background,color:textColor},children:[(0,jsx_runtime.jsx)("h2",{style:{color:textColor},children:headline}),(0,jsx_runtime.jsx)("div",{class:"hero-blurb",style:{color:textColor},children:tagline}),(0,jsx_runtime.jsxs)("button",{href:link,class:"hero-button","data-element-type":dataElementType,"data-promotion-index":datapromotionindex,"data-promotion-name":datapromotionname,children:[(0,jsx_runtime.jsxs)("span",{class:"swoosh-container",children:[(0,jsx_runtime.jsx)("span",{class:"star-start",children:(0,jsx_runtime.jsx)("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M4.23539 2.16758C4.31585 1.75612 4.83196 1.6292 5.09362 1.92958L6.64272 3.65653L8.92869 3.36308C9.33686 3.31475 9.62105 3.7548 9.41431 4.12022L8.26344 6.1095L9.24532 8.18833C9.41411 8.56311 9.07604 8.98116 8.67962 8.89652L6.43413 8.40043L4.74982 9.98635C4.45362 10.2631 3.94852 10.0788 3.90018 9.67067L3.67114 7.38306L1.6601 6.27065C1.29468 6.06391 1.31163 5.54034 1.6864 5.37155L3.81205 4.44154L4.23539 2.16758Z","fill-opacity":"0.5"})})}),(0,jsx_runtime.jsx)("span",{class:"swoosh",children:" "})]}),linktext,(0,jsx_runtime.jsx)("span",{class:"basket-icon",children:(0,jsx_runtime.jsx)("svg",{width:"22",height:"18",viewBox:"0 0 22 18",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M21.2401 7.57V8.14C21.2401 8.38 21.1601 8.58 20.9901 8.75C20.8201 8.92 20.6201 9 20.3801 9H20.0901L19.1601 15.57C19.0901 16 18.8901 16.35 18.5701 16.63C18.2501 16.9 17.8701 17.04 17.4401 17.04H4.36006C3.93006 17.04 3.55006 16.9 3.23006 16.63C2.91006 16.35 2.71006 16 2.64006 15.57L1.71006 9H1.42006C1.18006 9 0.980059 8.92 0.810059 8.75C0.640059 8.58 0.560059 8.38 0.560059 8.14V7.57C0.560059 7.33 0.640059 7.13 0.810059 6.96C0.980059 6.79 1.18006 6.71 1.42006 6.71H3.83006L7.67006 1.43C7.86006 1.17 8.11006 1.01 8.42006 0.960001C8.73006 0.910001 9.02006 0.980002 9.28006 1.18C9.54006 1.37 9.70006 1.62 9.75006 1.93C9.80006 2.24 9.73006 2.53 9.53006 2.79L6.66006 6.71H15.1401L12.2701 2.79C12.0801 2.53 12.0101 2.24 12.0501 1.93C12.1001 1.62 12.2501 1.37 12.5201 1.18C12.7801 0.990002 13.0701 0.920001 13.3801 0.960001C13.6901 1.01 13.9401 1.16 14.1301 1.43L17.9701 6.71H20.3801C20.6201 6.71 20.8201 6.79 20.9901 6.96C21.1601 7.13 21.2401 7.33 21.2401 7.57ZM7.73006 13.89V9.87C7.73006 9.63 7.65006 9.43 7.48006 9.26C7.31006 9.09 7.11006 9.01 6.87006 9.01C6.63006 9.01 6.43006 9.09 6.26006 9.26C6.09006 9.43 6.01006 9.63 6.01006 9.87V13.89C6.01006 14.13 6.09006 14.33 6.26006 14.5C6.43006 14.67 6.63006 14.75 6.87006 14.75C7.11006 14.75 7.31006 14.67 7.48006 14.5C7.65006 14.33 7.73006 14.13 7.73006 13.89ZM11.7501 13.89V9.87C11.7501 9.63 11.6701 9.43 11.5001 9.26C11.3301 9.09 11.1301 9.01 10.8901 9.01C10.6501 9.01 10.4501 9.09 10.2801 9.26C10.1101 9.43 10.0301 9.63 10.0301 9.87V13.89C10.0301 14.13 10.1101 14.33 10.2801 14.5C10.4501 14.67 10.6501 14.75 10.8901 14.75C11.1301 14.75 11.3301 14.67 11.5001 14.5C11.6701 14.33 11.7501 14.13 11.7501 13.89ZM15.7701 13.89V9.87C15.7701 9.63 15.6901 9.43 15.5201 9.26C15.3501 9.09 15.1501 9.01 14.9101 9.01C14.6701 9.01 14.4701 9.09 14.3001 9.26C14.1301 9.43 14.0501 9.63 14.0501 9.87V13.89C14.0501 14.13 14.1301 14.33 14.3001 14.5C14.4701 14.67 14.6701 14.75 14.9101 14.75C15.1501 14.75 15.3501 14.67 15.5201 14.5C15.6901 14.33 15.7701 14.13 15.7701 13.89Z"})})}),(0,jsx_runtime.jsx)("span",{class:"star-end",children:(0,jsx_runtime.jsx)("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M4.23539 2.16758C4.31585 1.75612 4.83196 1.6292 5.09362 1.92958L6.64272 3.65653L8.92869 3.36308C9.33686 3.31475 9.62105 3.7548 9.41431 4.12022L8.26344 6.1095L9.24532 8.18833C9.41411 8.56311 9.07604 8.98116 8.67962 8.89652L6.43413 8.40043L4.74982 9.98635C4.45362 10.2631 3.94852 10.0788 3.90018 9.67067L3.67114 7.38306L1.6601 6.27065C1.29468 6.06391 1.31163 5.54034 1.6864 5.37155L3.81205 4.44154L4.23539 2.16758Z","fill-opacity":"0.5"})})})]})]})]})}),(0,jsx_runtime.jsx)("script",{children:"\n        const container = document.querySelector('.media.snow');\n  if (!container) return;\n\n  const snowflakeCount = 100;\n  const symbols = ['❄', '❅', '❆'];\n\n  const random = (min, max) => Math.random() * (max - min) + min;\n\n  function createSnowflake() {\n    if (!container) return;\n    \n    const flake = document.createElement('div');\n    flake.classList.add('snowflake');\n    flake.innerText = symbols[Math.floor(Math.random() * symbols.length)];\n\n    flake.style.left = `${random(0, 100)}%`;\n    flake.style.fontSize = `${random(0.8, 2)}em`;\n    flake.style.opacity = random(0.5, 1);\n    flake.style.animationDuration = `${random(5, 10)}s`;\n    flake.style.animationDelay = `${random(0, 15)}s`;\n\n    flake.style.setProperty('--horizontal-drift', `${random(-15, 15)}vw`);\n    flake.style.setProperty('--rotation', `${random(-360, 360)}deg`);\n\n    if (Math.random() > 0.8) flake.classList.add('flare');\n    if (Math.random() > 0.5) flake.classList.add('blurred');\n\n    container.appendChild(flake);\n\n    flake.addEventListener('animationend', () => flake.remove());\n  }\n\n  for (let i = 0; i < snowflakeCount; i++) createSnowflake();\n\n  const interval = setInterval(createSnowflake, 500);\n\n  return () => {\n    clearInterval(interval);\n    container.innerHTML = '';\n  };\n      "})]})};HalfSplitHeroSnow.__docgenInfo={description:"Primary UI component for user interaction",methods:[],displayName:"HalfSplitHeroSnow",props:{image:{description:"contents",type:{name:"string"},required:!1},imagealt:{description:"",type:{name:"string"},required:!1},videosrc:{description:"",type:{name:"string"},required:!1},background:{description:"",type:{name:"string"},required:!1},textColor:{description:"",type:{name:"string"},required:!1},headline:{description:"",type:{name:"string"},required:!1},tagline:{description:"",type:{name:"string"},required:!1},link:{description:"",type:{name:"string"},required:!1},linktext:{description:"",type:{name:"string"},required:!1},dataElementType:{description:"",type:{name:"string"},required:!1},datapromotionindex:{description:"",type:{name:"string"},required:!1},datapromotionname:{description:"",type:{name:"string"},required:!1}}};var external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/preview-api");const _excluded=["user"],Halfsplitherosnow_stories={title:"Home/Hero/Half Split Hero Snow",component:HalfSplitHeroSnow,parameters:{layout:"centered"},argTypes:{background:{control:"color"},user:{options:["stories","hasina","shermin","sam"],control:{type:"select"}}}},HalfAndHalfHeroSnow={args:{user:"stories",image:"",imagealt:"",videosrc:"",background:"",textColor:"#FFFFFF",Logo:"",logoalt:"",headline:"New Toniebox 2 with Tonieplay",tagline:"Get ready for screen-free stories, songs and more!",link:"https://www.thetoyshop.com/brands/tonies",linktext:"Pre-order",dataElementType:"hp-hero-area",datapromotionindex:"3",datapromotionname:"Hero-3-Huffy"},render:function Render(args){const[currentArgs,updateArgs]=(0,external_STORYBOOK_MODULE_PREVIEW_API_.useArgs)(),isLoadingRef=(0,react.useRef)(!1),lastUserRef=(0,react.useRef)(args.user),lastSyncedData=(0,react.useRef)({});return(0,react.useEffect)((()=>{(async()=>{isLoadingRef.current=!0,lastUserRef.current=args.user;try{const docRef=(0,index_esm.H9)(firebase.db,args.user,"halfsplitherosnow"),snap=await(0,index_esm.x7)(docRef);if(snap.exists()){const firestoreData=snap.data();lastSyncedData.current=firestoreData,updateArgs((0,objectSpread2.A)((0,objectSpread2.A)((0,objectSpread2.A)({},currentArgs),firestoreData),{},{user:args.user}))}}catch(e){console.error("Firestore load error:",e)}isLoadingRef.current=!1})()}),[args.user]),(0,react.useEffect)((()=>{if(isLoadingRef.current)return;const selectedUser=lastUserRef.current;if(currentArgs.user!==selectedUser)return;const{user}=currentArgs,fields=(0,objectWithoutProperties.A)(currentArgs,_excluded),prevFields=lastSyncedData.current;if(!Object.entries(fields).some((_ref=>{let[k,v]=_ref;return prevFields[k]!==v})))return;lastSyncedData.current=fields;(async()=>{try{const docRef=(0,index_esm.H9)(firebase.db,selectedUser,"halfsplitherosnow");await(0,index_esm.mZ)(docRef,fields),console.log("UPDATED:",selectedUser,fields)}catch(e){console.error("Firestore update error:",e)}})()}),[currentArgs]),(0,jsx_runtime.jsx)(HalfSplitHeroSnow,(0,objectSpread2.A)({},currentArgs))}},__namedExportsOrder=["HalfAndHalfHeroSnow"];HalfAndHalfHeroSnow.parameters={...HalfAndHalfHeroSnow.parameters,docs:{...HalfAndHalfHeroSnow.parameters?.docs,source:{originalSource:"{\n  args: {\n    user: \"stories\",\n    image: '',\n    imagealt: '',\n    videosrc: '',\n    background: '',\n    textColor: '#FFFFFF',\n    Logo: '',\n    logoalt: '',\n    headline: 'New Toniebox 2 with Tonieplay',\n    tagline: 'Get ready for screen-free stories, songs and more!',\n    link: 'https://www.thetoyshop.com/brands/tonies',\n    linktext: 'Pre-order',\n    dataElementType: 'hp-hero-area',\n    datapromotionindex: '3',\n    datapromotionname: 'Hero-3-Huffy'\n  },\n  render: function Render(args) {\n    const [currentArgs, updateArgs] = useArgs();\n    const isLoadingRef = useRef(false); // prevents writing during load\n    const lastUserRef = useRef(args.user); // track selected user\n    const lastSyncedData = useRef({}); // prevent write loops\n\n    // -------------------------------------------------------\n    // 1. LOAD DATA FROM SELECTED USER\n    // -------------------------------------------------------\n    useEffect(() => {\n      const load = async () => {\n        isLoadingRef.current = true; // BLOCK updates\n        lastUserRef.current = args.user;\n        try {\n          const docRef = doc(db, args.user, \"halfsplitherosnow\");\n          const snap = await getDoc(docRef);\n          if (snap.exists()) {\n            const firestoreData = snap.data();\n            lastSyncedData.current = firestoreData;\n\n            // Replace storybook args with loaded data\n            updateArgs({\n              ...currentArgs,\n              ...firestoreData,\n              user: args.user\n            });\n          }\n        } catch (e) {\n          console.error(\"Firestore load error:\", e);\n        }\n        isLoadingRef.current = false; // allow updates again\n      };\n      load();\n    }, [args.user]);\n\n    // -------------------------------------------------------\n    // 2. SYNC ONLY FIELD CHANGES (NOT USER CHANGE)\n    // -------------------------------------------------------\n    useEffect(() => {\n      if (isLoadingRef.current) return; // Don't sync during load\n\n      const selectedUser = lastUserRef.current;\n\n      // Don't sync if this change is caused by selecting a new user\n      if (currentArgs.user !== selectedUser) return;\n\n      // Remove user field before writing\n      const {\n        user,\n        ...fields\n      } = currentArgs;\n\n      // Prevent re-writing unchanged data\n      const prevFields = lastSyncedData.current;\n      const changed = Object.entries(fields).some(([k, v]) => prevFields[k] !== v);\n      if (!changed) return;\n      lastSyncedData.current = fields;\n      const send = async () => {\n        try {\n          const docRef = doc(db, selectedUser, \"halfsplitherosnow\");\n          await updateDoc(docRef, fields);\n          console.log(\"UPDATED:\", selectedUser, fields);\n        } catch (e) {\n          console.error(\"Firestore update error:\", e);\n        }\n      };\n      send();\n    }, [currentArgs]);\n    return <HalfSplitHeroSnow {...currentArgs} />;\n  }\n}",...HalfAndHalfHeroSnow.parameters?.docs?.source}}}}}]);