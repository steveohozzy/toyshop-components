"use strict";(self.webpackChunkentertainer_redesign=self.webpackChunkentertainer_redesign||[]).push([[205],{"./src/config/firebase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{db:()=>db});var firebase_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/firebase/app/dist/esm/index.esm.js"),firebase_firestore__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js");const app=(0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.Wp)({apiKey:"AIzaSyDLmVO4qOiYb8dTm9tIUSUyZZXliuddo1c",authDomain:"storybook-58efc.firebaseapp.com",projectId:"storybook-58efc",storageBucket:"storybook-58efc.firebasestorage.app",messagingSenderId:"10714570266",appId:"1:10714570266:web:1086b72b26588d72193ba3"}),db=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.aU)(app)},"./src/stories/Discountcode.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DiscountCodeModule:()=>DiscountCodeModule,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Discountcode_stories});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),firebase=__webpack_require__("./src/config/firebase.js"),index_esm=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const DiscountCode=_ref=>{let{title,blurb,link,linktext,terms,termslink,expanding}=_ref;return setTimeout((function(){document.querySelectorAll(".terms-button").forEach((function(button){button.addEventListener("click",(function(e){e.target.classList.toggle("active"),e.target.closest(".code-box").querySelector(".terms").classList.toggle("active")}))}))}),1e3),(0,jsx_runtime.jsx)("div",{class:"container discount-code-container",children:(0,jsx_runtime.jsxs)("div",{class:"code-box ".concat(!expanding&&"non-expanding"),children:[(0,jsx_runtime.jsx)("h3",{children:title}),(0,jsx_runtime.jsx)("div",{dangerouslySetInnerHTML:{__html:blurb}}),(0,jsx_runtime.jsxs)("div",{class:"buttons",children:[expanding?(0,jsx_runtime.jsxs)("button",{class:"terms-button expander",children:["Read Terms & Conditions",(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"15px",height:"15px",viewBox:"0 0 24 24",fill:"none",children:(0,jsx_runtime.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.29289 8.29289C4.68342 7.90237 5.31658 7.90237 5.70711 8.29289L12 14.5858L18.2929 8.29289C18.6834 7.90237 19.3166 7.90237 19.7071 8.29289C20.0976 8.68342 20.0976 9.31658 19.7071 9.70711L12.7071 16.7071C12.3166 17.0976 11.6834 17.0976 11.2929 16.7071L4.29289 9.70711C3.90237 9.31658 3.90237 8.68342 4.29289 8.29289Z",fill:"#0D5D9C"})})]}):(0,jsx_runtime.jsxs)("a",{class:"terms-button",href:termslink,children:["Read Terms & Conditions",(0,jsx_runtime.jsx)("svg",{fill:"none",height:"15px",viewbox:"0 0 24 24",width:"15px",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{"clip-rule":"evenodd",d:"M4.29289 8.29289C4.68342 7.90237 5.31658 7.90237 5.70711 8.29289L12 14.5858L18.2929 8.29289C18.6834 7.90237 19.3166 7.90237 19.7071 8.29289C20.0976 8.68342 20.0976 9.31658 19.7071 9.70711L12.7071 16.7071C12.3166 17.0976 11.6834 17.0976 11.2929 16.7071L4.29289 9.70711C3.90237 9.31658 3.90237 8.68342 4.29289 8.29289Z",fill:"#0D5D9C","fill-rule":"evenodd"})})]}),(0,jsx_runtime.jsx)("a",{class:"link",href:link,children:linktext})]}),(0,jsx_runtime.jsx)("div",{class:"terms",children:(0,jsx_runtime.jsx)("div",{class:"terms-inner",dangerouslySetInnerHTML:{__html:terms}})})]})})};DiscountCode.__docgenInfo={description:"Primary UI component for user interaction",methods:[],displayName:"DiscountCode",props:{expanding:{description:"Discount Code Module contents",type:{name:"bool"},required:!1},title:{description:"",type:{name:"string"},required:!0},blurb:{description:"",type:{name:"string"},required:!0},link:{description:"",type:{name:"string"},required:!0},linktext:{description:"",type:{name:"string"},required:!0},terms:{description:"",type:{name:"string"},required:!1},termslink:{description:"",type:{name:"string"},required:!1}}};var external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/preview-api");const Discountcode_stories={title:"Components/Discount Code",component:DiscountCode,parameters:{layout:"centered"}},DiscountCodeModule={args:{expanding:!0,title:"",blurb:"",link:"",linktext:"",termslink:"",terms:""},render:function Render(args){const[currentArgs,updateArgs]=(0,external_STORYBOOK_MODULE_PREVIEW_API_.useArgs)(),hasLoadedFromFirestore=(0,react.useRef)(!1);(0,react.useEffect)((()=>{(async()=>{try{const docRef=(0,index_esm.H9)(firebase.db,"stories","discountcode"),snapshot=await(0,index_esm.x7)(docRef);if(snapshot.exists()){const data=snapshot.data();updateArgs((0,objectSpread2.A)((0,objectSpread2.A)({},args),data))}else console.warn("No such document: discountcode")}catch(err){console.error("Error fetching from Firestore:",err)}finally{hasLoadedFromFirestore.current=!0}})()}),[]);const syncAllArgsToFirebase=(0,react.useCallback)((async newArgs=>{if(hasLoadedFromFirestore.current)try{const docRef=(0,index_esm.H9)(firebase.db,"stories","discountcode"),cleanedArgs={};for(const[key,value]of Object.entries(newArgs))cleanedArgs[key]="string"==typeof value&&""===value.trim()?"":value;await(0,index_esm.mZ)(docRef,cleanedArgs),console.log("✅ Firestore updated:",cleanedArgs)}catch(err){console.error("Error updating Firestore:",err)}}),[]);return(0,react.useEffect)((()=>{hasLoadedFromFirestore.current&&syncAllArgsToFirebase(currentArgs)}),[currentArgs,syncAllArgsToFirebase]),(0,jsx_runtime.jsx)(DiscountCode,(0,objectSpread2.A)({},args))}},__namedExportsOrder=["DiscountCodeModule"];DiscountCodeModule.parameters={...DiscountCodeModule.parameters,docs:{...DiscountCodeModule.parameters?.docs,source:{originalSource:"{\n  args: {\n    expanding: true,\n    title: '',\n    blurb: ``,\n    link: '',\n    linktext: '',\n    termslink: '',\n    terms: ``\n  },\n  render: function Render(args) {\n    const [currentArgs, updateArgs] = useArgs();\n    const hasLoadedFromFirestore = useRef(false);\n\n    // --- Load all fields from Firestore once ---\n    useEffect(() => {\n      const loadFromFirebase = async () => {\n        try {\n          const docRef = doc(db, 'stories', 'discountcode');\n          const snapshot = await getDoc(docRef);\n          if (snapshot.exists()) {\n            const data = snapshot.data();\n\n            // Merge data from Firestore into Storybook args\n            updateArgs({\n              ...args,\n              ...data\n            });\n          } else {\n            console.warn('No such document: discountcode');\n          }\n        } catch (err) {\n          console.error('Error fetching from Firestore:', err);\n        } finally {\n          hasLoadedFromFirestore.current = true;\n        }\n      };\n      loadFromFirebase();\n    }, []);\n\n    // --- Generic Firestore sync for all fields ---\n    const syncAllArgsToFirebase = useCallback(async newArgs => {\n      if (!hasLoadedFromFirestore.current) return; // skip before load\n\n      try {\n        const docRef = doc(db, 'stories', 'discountcode');\n\n        // Clean values before saving\n        const cleanedArgs = {};\n        for (const [key, value] of Object.entries(newArgs)) {\n          // Normalize empty values to empty strings\n          cleanedArgs[key] = typeof value === 'string' && value.trim() === '' ? '' : value;\n        }\n        await updateDoc(docRef, cleanedArgs);\n        console.log('✅ Firestore updated:', cleanedArgs);\n      } catch (err) {\n        console.error('Error updating Firestore:', err);\n      }\n    }, []);\n\n    // --- Watch for *any* arg change and sync ---\n    useEffect(() => {\n      if (!hasLoadedFromFirestore.current) return;\n      syncAllArgsToFirebase(currentArgs);\n    }, [currentArgs, syncAllArgsToFirebase]);\n    return <DiscountCode {...args} />;\n  }\n}",...DiscountCodeModule.parameters?.docs?.source}}}}}]);