"use strict";(self.webpackChunkentertainer_redesign=self.webpackChunkentertainer_redesign||[]).push([[373],{"./src/config/firebase.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{db:()=>db});var firebase_app__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/firebase/app/dist/esm/index.esm.js"),firebase_firestore__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js");const app=(0,firebase_app__WEBPACK_IMPORTED_MODULE_0__.Wp)({apiKey:"AIzaSyDLmVO4qOiYb8dTm9tIUSUyZZXliuddo1c",authDomain:"storybook-58efc.firebaseapp.com",projectId:"storybook-58efc",storageBucket:"storybook-58efc.firebasestorage.app",messagingSenderId:"10714570266",appId:"1:10714570266:web:1086b72b26588d72193ba3"}),db=(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_1__.aU)(app)},"./src/stories/Eventmodule.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EventModuleComponent:()=>EventModuleComponent,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Eventmodule_stories});var objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),firebase=__webpack_require__("./src/config/firebase.js"),index_esm=__webpack_require__("./node_modules/firebase/firestore/dist/esm/index.esm.js"),react=__webpack_require__("./node_modules/react/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const EventModule=_ref=>{let{id,title,image,imagealt,buttontext,buttonlink,blurb,row1date,row1location,row1locationlink,row1price,row2date,row2location,row2locationlink,row2price,row3date,row3location,row3locationlink,row3price,row4date,row4location,row4locationlink,row4price,row5date,row5location,row5locationlink,row5price,row6date,row6location,row6locationlink,row6price,row7date,row7location,row7locationlink,row7price,row8date,row8location,row8locationlink,row8price,row9date,row9location,row9locationlink,row9price,row10date,row10location,row10locationlink,row10price}=_ref;return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsxs)("div",{class:"event-container",id,children:[(0,jsx_runtime.jsxs)("div",{class:"image-container",children:[(0,jsx_runtime.jsx)("div",{class:"event-title",children:title}),(0,jsx_runtime.jsx)("img",{src:image,alt:imagealt,title:imagealt}),(0,jsx_runtime.jsxs)("a",{href:buttonlink,class:"hero-button",children:[(0,jsx_runtime.jsxs)("span",{class:"swoosh-container",children:[(0,jsx_runtime.jsx)("span",{class:"star-start",children:(0,jsx_runtime.jsx)("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M4.23539 2.16758C4.31585 1.75612 4.83196 1.6292 5.09362 1.92958L6.64272 3.65653L8.92869 3.36308C9.33686 3.31475 9.62105 3.7548 9.41431 4.12022L8.26344 6.1095L9.24532 8.18833C9.41411 8.56311 9.07604 8.98116 8.67962 8.89652L6.43413 8.40043L4.74982 9.98635C4.45362 10.2631 3.94852 10.0788 3.90018 9.67067L3.67114 7.38306L1.6601 6.27065C1.29468 6.06391 1.31163 5.54034 1.6864 5.37155L3.81205 4.44154L4.23539 2.16758Z","fill-opacity":"0.5"})})}),(0,jsx_runtime.jsx)("span",{class:"swoosh",children:"Â "})]}),buttontext,(0,jsx_runtime.jsx)("span",{class:"basket-icon",children:(0,jsx_runtime.jsx)("svg",{width:"22",height:"18",viewBox:"0 0 22 18",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M21.2401 7.57V8.14C21.2401 8.38 21.1601 8.58 20.9901 8.75C20.8201 8.92 20.6201 9 20.3801 9H20.0901L19.1601 15.57C19.0901 16 18.8901 16.35 18.5701 16.63C18.2501 16.9 17.8701 17.04 17.4401 17.04H4.36006C3.93006 17.04 3.55006 16.9 3.23006 16.63C2.91006 16.35 2.71006 16 2.64006 15.57L1.71006 9H1.42006C1.18006 9 0.980059 8.92 0.810059 8.75C0.640059 8.58 0.560059 8.38 0.560059 8.14V7.57C0.560059 7.33 0.640059 7.13 0.810059 6.96C0.980059 6.79 1.18006 6.71 1.42006 6.71H3.83006L7.67006 1.43C7.86006 1.17 8.11006 1.01 8.42006 0.960001C8.73006 0.910001 9.02006 0.980002 9.28006 1.18C9.54006 1.37 9.70006 1.62 9.75006 1.93C9.80006 2.24 9.73006 2.53 9.53006 2.79L6.66006 6.71H15.1401L12.2701 2.79C12.0801 2.53 12.0101 2.24 12.0501 1.93C12.1001 1.62 12.2501 1.37 12.5201 1.18C12.7801 0.990002 13.0701 0.920001 13.3801 0.960001C13.6901 1.01 13.9401 1.16 14.1301 1.43L17.9701 6.71H20.3801C20.6201 6.71 20.8201 6.79 20.9901 6.96C21.1601 7.13 21.2401 7.33 21.2401 7.57ZM7.73006 13.89V9.87C7.73006 9.63 7.65006 9.43 7.48006 9.26C7.31006 9.09 7.11006 9.01 6.87006 9.01C6.63006 9.01 6.43006 9.09 6.26006 9.26C6.09006 9.43 6.01006 9.63 6.01006 9.87V13.89C6.01006 14.13 6.09006 14.33 6.26006 14.5C6.43006 14.67 6.63006 14.75 6.87006 14.75C7.11006 14.75 7.31006 14.67 7.48006 14.5C7.65006 14.33 7.73006 14.13 7.73006 13.89ZM11.7501 13.89V9.87C11.7501 9.63 11.6701 9.43 11.5001 9.26C11.3301 9.09 11.1301 9.01 10.8901 9.01C10.6501 9.01 10.4501 9.09 10.2801 9.26C10.1101 9.43 10.0301 9.63 10.0301 9.87V13.89C10.0301 14.13 10.1101 14.33 10.2801 14.5C10.4501 14.67 10.6501 14.75 10.8901 14.75C11.1301 14.75 11.3301 14.67 11.5001 14.5C11.6701 14.33 11.7501 14.13 11.7501 13.89ZM15.7701 13.89V9.87C15.7701 9.63 15.6901 9.43 15.5201 9.26C15.3501 9.09 15.1501 9.01 14.9101 9.01C14.6701 9.01 14.4701 9.09 14.3001 9.26C14.1301 9.43 14.0501 9.63 14.0501 9.87V13.89C14.0501 14.13 14.1301 14.33 14.3001 14.5C14.4701 14.67 14.6701 14.75 14.9101 14.75C15.1501 14.75 15.3501 14.67 15.5201 14.5C15.6901 14.33 15.7701 14.13 15.7701 13.89Z"})})}),(0,jsx_runtime.jsx)("span",{class:"star-end",children:(0,jsx_runtime.jsx)("svg",{width:"11",height:"11",viewBox:"0 0 11 11",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,jsx_runtime.jsx)("path",{d:"M4.23539 2.16758C4.31585 1.75612 4.83196 1.6292 5.09362 1.92958L6.64272 3.65653L8.92869 3.36308C9.33686 3.31475 9.62105 3.7548 9.41431 4.12022L8.26344 6.1095L9.24532 8.18833C9.41411 8.56311 9.07604 8.98116 8.67962 8.89652L6.43413 8.40043L4.74982 9.98635C4.45362 10.2631 3.94852 10.0788 3.90018 9.67067L3.67114 7.38306L1.6601 6.27065C1.29468 6.06391 1.31163 5.54034 1.6864 5.37155L3.81205 4.44154L4.23539 2.16758Z","fill-opacity":"0.5"})})})]})]}),(0,jsx_runtime.jsxs)("div",{class:"event-details",children:[(0,jsx_runtime.jsx)("div",{class:"character-intro",dangerouslySetInnerHTML:{__html:blurb}}),(0,jsx_runtime.jsxs)("ul",{class:"event-dates",children:[(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row1date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row1locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row1location),rel:"noreferrer",children:row1location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row1price," "]})]}),row2date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row2date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row2locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row2location),rel:"noreferrer",children:row2location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row2price," "]})]}),row3date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row3date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row3locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row3location),rel:"noreferrer",children:row3location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row3price," "]})]}),row4date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row4date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row4locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row4location),rel:"noreferrer",children:row4location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row4price," "]})]}),row5date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row5date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row5locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row5location),rel:"noreferrer",children:row5location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row5price," "]})]}),row6date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row6date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row6locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row6location),rel:"noreferrer",children:row6location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row6price," "]})]}),row7date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row7date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row7locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row7location),rel:"noreferrer",children:row7location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row7price," "]})]}),row8date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row8date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row8locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row8location),rel:"noreferrer",children:row8location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row8price," "]})]}),row9date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row9date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row9locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row9location),rel:"noreferrer",children:row9location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row9price," "]})]}),row10date&&(0,jsx_runtime.jsxs)("li",{children:[(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("strong",{children:row10date})}),(0,jsx_runtime.jsx)("span",{children:(0,jsx_runtime.jsx)("a",{href:row10locationlink,target:"_blank",title:"The Entertainer in\n              ".concat(row10location),rel:"noreferrer",children:row10location})}),(0,jsx_runtime.jsxs)("span",{class:"price",children:[" ",row10price," "]})]})]})]})]})})};EventModule.__docgenInfo={description:"Primary UI component for user interaction",methods:[],displayName:"EventModule",props:{id:{description:"Event contents",type:{name:"string"},required:!1},title:{description:"",type:{name:"string"},required:!1},image:{description:"",type:{name:"string"},required:!1},imagealt:{description:"",type:{name:"string"},required:!1},buttontext:{description:"",type:{name:"string"},required:!1},buttonlink:{description:"",type:{name:"string"},required:!1},blurb:{description:"",type:{name:"string"},required:!1},row1date:{description:"",type:{name:"string"},required:!1},row1location:{description:"",type:{name:"string"},required:!1},row1locationlink:{description:"",type:{name:"string"},required:!1},row1price:{description:"",type:{name:"string"},required:!1},row2date:{description:"",type:{name:"string"},required:!1},row2location:{description:"",type:{name:"string"},required:!1},row2locationlink:{description:"",type:{name:"string"},required:!1},row2price:{description:"",type:{name:"string"},required:!1},row3date:{description:"",type:{name:"string"},required:!1},row3location:{description:"",type:{name:"string"},required:!1},row3locationlink:{description:"",type:{name:"string"},required:!1},row3price:{description:"",type:{name:"string"},required:!1},row4date:{description:"",type:{name:"string"},required:!1},row4location:{description:"",type:{name:"string"},required:!1},row4locationlink:{description:"",type:{name:"string"},required:!1},row4price:{description:"",type:{name:"string"},required:!1},row5date:{description:"",type:{name:"string"},required:!1},row5location:{description:"",type:{name:"string"},required:!1},row5locationlink:{description:"",type:{name:"string"},required:!1},row5price:{description:"",type:{name:"string"},required:!1},row6date:{description:"",type:{name:"string"},required:!1},row6location:{description:"",type:{name:"string"},required:!1},row6locationlink:{description:"",type:{name:"string"},required:!1},row6price:{description:"",type:{name:"string"},required:!1},row7date:{description:"",type:{name:"string"},required:!1},row7location:{description:"",type:{name:"string"},required:!1},row7locationlink:{description:"",type:{name:"string"},required:!1},row7price:{description:"",type:{name:"string"},required:!1},row8date:{description:"",type:{name:"string"},required:!1},row8location:{description:"",type:{name:"string"},required:!1},row8locationlink:{description:"",type:{name:"string"},required:!1},row8price:{description:"",type:{name:"string"},required:!1},row9date:{description:"",type:{name:"string"},required:!1},row9location:{description:"",type:{name:"string"},required:!1},row9locationlink:{description:"",type:{name:"string"},required:!1},row9price:{description:"",type:{name:"string"},required:!1},row10date:{description:"",type:{name:"string"},required:!1},row10location:{description:"",type:{name:"string"},required:!1},row10locationlink:{description:"",type:{name:"string"},required:!1},row10price:{description:"",type:{name:"string"},required:!1}}};var external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/preview-api");const _excluded=["user"],Eventmodule_stories={title:"Components/Event Module",component:EventModule,parameters:{layout:"centered"},argTypes:{user:{options:["stories","hasina","shermin","sam"],control:{type:"select"}}}},EventModuleComponent={args:{user:"stories",id:"",image:"",imagealt:"",title:"",buttontext:"",buttonlink:"",blurb:"",row1date:"",row1location:"",row1locationlink:"",row1price:"",row2date:"",row2location:"",row2locationlink:"",row2price:"",row3date:"",row3location:"",row3locationlink:"",row3price:"",row4date:"",row4location:"",row4locationlink:"",row4price:"",row5date:"",row5location:"",row5locationlink:"",row5price:"",row6date:"",row6location:"",row6locationlink:"",row6price:"",row7date:"",row7location:"",row7locationlink:"",row7price:"",row8date:"",row8location:"",row8locationlink:"",row8price:"",row9date:"",row9location:"",row9locationlink:"",row9price:"",row10date:"",row10location:"",row10locationlink:"",row10price:""},render:function Render(args){const[currentArgs,updateArgs]=(0,external_STORYBOOK_MODULE_PREVIEW_API_.useArgs)(),isLoadingRef=(0,react.useRef)(!1),lastUserRef=(0,react.useRef)(args.user),lastSyncedData=(0,react.useRef)({});return(0,react.useEffect)((()=>{(async()=>{isLoadingRef.current=!0,lastUserRef.current=args.user;try{const docRef=(0,index_esm.H9)(firebase.db,args.user,"eventmodule"),snap=await(0,index_esm.x7)(docRef);if(snap.exists()){const firestoreData=snap.data();lastSyncedData.current=firestoreData,updateArgs((0,objectSpread2.A)((0,objectSpread2.A)((0,objectSpread2.A)({},currentArgs),firestoreData),{},{user:args.user}))}}catch(e){console.error("Firestore load error:",e)}isLoadingRef.current=!1})()}),[args.user]),(0,react.useEffect)((()=>{if(isLoadingRef.current)return;const selectedUser=lastUserRef.current;if(currentArgs.user!==selectedUser)return;const{user}=currentArgs,fields=(0,objectWithoutProperties.A)(currentArgs,_excluded),prevFields=lastSyncedData.current;if(!Object.entries(fields).some((_ref=>{let[k,v]=_ref;return prevFields[k]!==v})))return;lastSyncedData.current=fields;(async()=>{try{const docRef=(0,index_esm.H9)(firebase.db,selectedUser,"eventmodule");await(0,index_esm.mZ)(docRef,fields),console.log("UPDATED:",selectedUser,fields)}catch(e){console.error("Firestore update error:",e)}})()}),[currentArgs]),(0,jsx_runtime.jsx)(EventModule,(0,objectSpread2.A)({},args))}},__namedExportsOrder=["EventModuleComponent"];EventModuleComponent.parameters={...EventModuleComponent.parameters,docs:{...EventModuleComponent.parameters?.docs,source:{originalSource:"{\n  args: {\n    user: 'stories',\n    id: '',\n    image: '',\n    imagealt: '',\n    title: '',\n    buttontext: '',\n    buttonlink: '',\n    blurb: ``,\n    row1date: '',\n    row1location: '',\n    row1locationlink: '',\n    row1price: '',\n    row2date: '',\n    row2location: '',\n    row2locationlink: '',\n    row2price: '',\n    row3date: '',\n    row3location: '',\n    row3locationlink: '',\n    row3price: '',\n    row4date: '',\n    row4location: '',\n    row4locationlink: '',\n    row4price: '',\n    row5date: '',\n    row5location: '',\n    row5locationlink: '',\n    row5price: '',\n    row6date: '',\n    row6location: '',\n    row6locationlink: '',\n    row6price: '',\n    row7date: '',\n    row7location: '',\n    row7locationlink: '',\n    row7price: '',\n    row8date: '',\n    row8location: '',\n    row8locationlink: '',\n    row8price: '',\n    row9date: '',\n    row9location: '',\n    row9locationlink: '',\n    row9price: '',\n    row10date: '',\n    row10location: '',\n    row10locationlink: '',\n    row10price: ''\n  },\n  render: function Render(args) {\n    const [currentArgs, updateArgs] = useArgs();\n    const isLoadingRef = useRef(false); // prevents writing during load\n    const lastUserRef = useRef(args.user); // track selected user\n    const lastSyncedData = useRef({}); // prevent write loops\n\n    // -------------------------------------------------------\n    // 1. LOAD DATA FROM SELECTED USER\n    // -------------------------------------------------------\n    useEffect(() => {\n      const load = async () => {\n        isLoadingRef.current = true; // BLOCK updates\n        lastUserRef.current = args.user;\n        try {\n          const docRef = doc(db, args.user, \"eventmodule\");\n          const snap = await getDoc(docRef);\n          if (snap.exists()) {\n            const firestoreData = snap.data();\n            lastSyncedData.current = firestoreData;\n\n            // Replace storybook args with loaded data\n            updateArgs({\n              ...currentArgs,\n              ...firestoreData,\n              user: args.user\n            });\n          }\n        } catch (e) {\n          console.error(\"Firestore load error:\", e);\n        }\n        isLoadingRef.current = false; // allow updates again\n      };\n      load();\n    }, [args.user]);\n\n    // -------------------------------------------------------\n    // 2. SYNC ONLY FIELD CHANGES (NOT USER CHANGE)\n    // -------------------------------------------------------\n    useEffect(() => {\n      if (isLoadingRef.current) return; // Don't sync during load\n\n      const selectedUser = lastUserRef.current;\n\n      // Don't sync if this change is caused by selecting a new user\n      if (currentArgs.user !== selectedUser) return;\n\n      // Remove user field before writing\n      const {\n        user,\n        ...fields\n      } = currentArgs;\n\n      // Prevent re-writing unchanged data\n      const prevFields = lastSyncedData.current;\n      const changed = Object.entries(fields).some(([k, v]) => prevFields[k] !== v);\n      if (!changed) return;\n      lastSyncedData.current = fields;\n      const send = async () => {\n        try {\n          const docRef = doc(db, selectedUser, \"eventmodule\");\n          await updateDoc(docRef, fields);\n          console.log(\"UPDATED:\", selectedUser, fields);\n        } catch (e) {\n          console.error(\"Firestore update error:\", e);\n        }\n      };\n      send();\n    }, [currentArgs]);\n    return <EventModule {...args} />;\n  }\n}",...EventModuleComponent.parameters?.docs?.source}}}}}]);